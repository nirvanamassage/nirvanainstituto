-- Create the servicos table
create table if not exists public.servicos (
    id bigint generated by default as identity primary key,
    titulo text not null,
    emoji text,
    imagem text not null,
    descricao text not null,
    created_at timestamptz default now()
);

-- Set up Row Level Security (RLS)
alter table public.servicos enable row level security;

-- Create policies
create policy "Servi√ßos s√£o vis√≠veis para todos"
    on public.servicos for select
    to public
    using (true);

create policy "Apenas usu√°rios autenticados podem inserir servi√ßos"
    on public.servicos for insert
    to authenticated
    with check (true);

create policy "Apenas usu√°rios autenticados podem atualizar servi√ßos"
    on public.servicos for update
    to authenticated
    using (true);

create policy "Apenas usu√°rios autenticados podem deletar servi√ßos"
    on public.servicos for delete
    to authenticated
    using (true);

-- Create storage bucket for servicos
insert into storage.buckets (id, name, public) 
values ('servicos', 'servicos', true);

-- Storage policy for public access to read images
create policy "Imagens s√£o p√∫blicas"
    on storage.objects for select
    to public
    using ( bucket_id = 'servicos' );

-- Storage policy for authenticated users to upload images
create policy "Usu√°rios autenticados podem fazer upload"
    on storage.objects for insert
    to authenticated
    with check ( bucket_id = 'servicos' );

-- Storage policy for authenticated users to update images
create policy "Usu√°rios autenticados podem atualizar imagens"
    on storage.objects for update
    to authenticated
    with check ( bucket_id = 'servicos' );

-- Storage policy for authenticated users to delete images
create policy "Usu√°rios autenticados podem deletar imagens"
    on storage.objects for delete
    to authenticated
    using ( bucket_id = 'servicos' );

-- Insert initial services
insert into public.servicos (titulo, emoji, imagem, descricao) values
    ('Massagem Relaxante', 'üëêüíÜ‚Äç‚ôÇÔ∏è', '/massagem-relaxante.jpg', 'Uma experi√™ncia cl√°ssica e revigorante que alivia o estresse e as tens√µes musculares. Com movimentos suaves e cont√≠nuos, promove relaxamento profundo, melhora a circula√ß√£o e proporciona uma sensa√ß√£o de leveza e bem-estar.'),
    ('Massagem T√¢ntrica', 'üî•üí´', '/massagem-tantrica.jpg', 'Uma jornada sensorial que desperta os sentidos e desbloqueia a energia vital. Atrav√©s de toques sutis e envolventes, essa massagem proporciona prazer, autoconhecimento e uma conex√£o mais profunda com o pr√≥prio corpo.'),
    ('Massagem Tailandesa', 'üßò‚Äç‚ôÇÔ∏èüåø', '/massagem-tailandesa.jpg', 'Uma t√©cnica milenar que combina alongamentos, press√µes e manipula√ß√µes inspiradas na yoga. Perfeita para aliviar tens√µes, melhorar a flexibilidade e restaurar o equil√≠brio energ√©tico do corpo.'),
    ('Massagem Nurum', '‚ú®üåä', '/massagem-nurum.jpg', 'Uma experi√™ncia ex√≥tica e extremamente prazerosa, onde a terapeuta desliza suavemente sobre o corpo do cliente utilizando um gel especial. Essa t√©cnica proporciona relaxamento intenso e uma conex√£o sensorial √∫nica.'),
    ('Massagem Fast Relax', '‚ö°‚è≥', '/massagem-fast.jpg', 'Ideal para quem tem pouco tempo, mas precisa de um al√≠vio imediato do estresse. Com t√©cnicas r√°pidas e eficazes, essa massagem foca nas √°reas de maior tens√£o, proporcionando relaxamento instant√¢neo em poucos minutos.'); 